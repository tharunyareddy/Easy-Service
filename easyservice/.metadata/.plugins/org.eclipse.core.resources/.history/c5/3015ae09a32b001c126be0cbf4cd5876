package com.easyservice.controllers;

import java.time.LocalDate;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.easyservice.model.Maintenance;
import com.easyservice.model.Priority;
import com.easyservice.model.Status;
import com.easyservice.model.Task;
import com.easyservice.service.IMaintenanceService;

/**
 * @author GAYATHRI S
 *
 */

@RestController
@RequestMapping("/maintenance-service")
public class MaintenanceController {

	IMaintenanceService maintenanceService;

	@Autowired
	public void setMaintenanceService(IMaintenanceService maintenanceService) {
		this.maintenanceService = maintenanceService;
	}

	Maintenance maintenances = new Maintenance();
	List<Maintenance> maintenanceList = null;
	Task task=new Task();

//	@PostMapping("/maintenance")
//	ResponseEntity<Maintenance> addMaintenance(@RequestBody Maintenance maintenance) {
//		maintenances = maintenanceService.addMaintenance(maintenance);
//		HttpHeaders headers = new HttpHeaders();
//		headers.add("desc", "Maintenance added");
//		return ResponseEntity.status(HttpStatus.CREATED).headers(headers).body(maintenances);
//	}

	@PostMapping("/maintenance")
	Maintenance addMaintenance(@RequestBody Maintenance maintenance){
	Maintenance maintenance1= maintenanceService.addMaintenance(maintenance);
	return maintenance1;
	}
	
	@PutMapping("/maintenance")
	ResponseEntity<String> updateMaintenance(@RequestBody Maintenance maintenance) {
		maintenanceService.updateMaintenance(maintenance);
		return ResponseEntity.status(HttpStatus.ACCEPTED).body("Updated !!!");
	}

	@DeleteMapping("/maintenance/{maintenanceId}")
	ResponseEntity<String> deleteMaintenance(@PathVariable("maintenanceId") int maintenanceId) {
		maintenanceService.deleteMaintenance(maintenanceId);
		return ResponseEntity.status(HttpStatus.OK).body("Deleted Successfully");
	}

	@GetMapping("/maintenance/{maintenanceId}")
	ResponseEntity<Maintenance> getById(@PathVariable("maintenanceId") int maintenanceId) {
		maintenances = maintenanceService.getById(maintenanceId);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get One Maintenance By Id");
		headers.add("info", "Returning one Maintenance");
		return ResponseEntity.status(HttpStatus.OK).headers(headers).body(maintenances);
	}

	// http://localhost:8071/maintenance-service/maintenance
	@GetMapping("/maintenance")
	ResponseEntity<List<Maintenance>> getAll() {
		maintenanceList = maintenanceService.getAll();
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get all maintenance");
		return ResponseEntity.accepted().headers(headers).body(maintenanceList);
	}

	@GetMapping("/maintenance/maintenanceName/{maintenanceName}")
	ResponseEntity<Maintenance> getByMaintenanceName(@PathVariable("maintenanceName") String maintenanceName) {
		Maintenance maintenances = maintenanceService.getByMaintenanceName(maintenanceName);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by maintenance name");
		return ResponseEntity.ok().headers(headers).body(maintenances);

	}

	@GetMapping("/maintenance/maintenanceManager/{maintenanceManager}")
	ResponseEntity<Maintenance> getByMaintenanceManager(@PathVariable("maintenanceManager") String maintenanceManager) {
		Maintenance maintenances = maintenanceService.getByMaintenanceManager(maintenanceManager);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by maintenance name");
		return ResponseEntity.ok().headers(headers).body(maintenances);

	}

	@GetMapping("/maintenance/maintenanceStartDate/{mStartDate}")
	ResponseEntity<List<Maintenance>> getByMaintenanceStartDate(@PathVariable("mStartDate") String mStartDate) {
		maintenanceList = maintenanceService.getByMaintenanceStartDate(LocalDate.parse(mStartDate));
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by start date");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	@GetMapping("/maintenance/maintenanceEndDate/{mEndDate}")
	ResponseEntity<List<Maintenance>> getByMaintenanceEndDate(@PathVariable("mEndDate") String mEndDate) {
		maintenanceList = maintenanceService.getByMaintenanceEndDate(LocalDate.parse(mEndDate));
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by end date");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	@GetMapping("/maintenance/maintenanceStatus/{mStatus}")
	ResponseEntity<List<Maintenance>> getByMaintenanceStatus(@PathVariable("mStatus") Status mStatus) {
		maintenanceList = maintenanceService.getByMaintenanceStatus(mStatus);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by status");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	@GetMapping("/maintenance/maintenancePriority/{mPriority}")
	ResponseEntity<List<Maintenance>> getByMaintenancePriority(@PathVariable("mPriority") Priority mPriority) {
		maintenanceList = maintenanceService.getByMaintenancePriority(mPriority);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by priority");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	@GetMapping("/maintenance/maintenanceStartDate/{mStartDate}/maintenanceEndDate/{mEndDate}")
	ResponseEntity<List<Maintenance>> getByMaintenanceStartAndEndDate(@PathVariable("mStartDate") String mStartDate,
			@PathVariable("mEndDate") String mEndDate) {
		maintenanceList = maintenanceService.getByMaintenanceStartAndEndDate(LocalDate.parse(mStartDate),
				LocalDate.parse(mEndDate));
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by start date and end date");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	//

	@GetMapping("/maintenance/maintenanceStatus/{mStatus}/maintenancePriority/{mPriority}")
	ResponseEntity<List<Maintenance>> getByMaintenanceStatusAndPriority(@PathVariable("mStatus") Status mStatus,
			@PathVariable("mPriority") Priority mPriority) {
		maintenanceList = maintenanceService.getByMaintenanceStatusAndPriority(mStatus, mPriority);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by status and priority");
		return ResponseEntity.ok().headers(headers).body(maintenanceList);
	}

	// **
	@GetMapping("/maintenance/maintenanceName/{maintenanceName}/maintenanceStatus/{mStatus}")
	ResponseEntity<Maintenance> getByMaintenanceNameAndStatus(@PathVariable("maintenanceName") String maintenanceName,
			@PathVariable("mStatus") Status mStatus) {
		maintenances = maintenanceService.getByMaintenanceNameAndStatus(maintenanceName, mStatus);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by status and name");
		return ResponseEntity.ok().headers(headers).body(maintenances);
	}

	@GetMapping("/maintenance/maintenanceName/{maintenanceName}/maintenancePriority/{mPriority}")
	ResponseEntity<Maintenance> getByMaintenanceNameAndPriority(@PathVariable("maintenanceName") String maintenanceName,
			@PathVariable("mPriority") Priority mPriority) {
		maintenances = maintenanceService.getByMaintenanceNameAndPriority(maintenanceName, mPriority);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get by start date");
		return ResponseEntity.ok().headers(headers).body(maintenances);
	}


	@PostMapping("/tasks")
	ResponseEntity<Task> addTask(@RequestBody Task task) {
		task = maintenanceService.addTask(task);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Task added");
		return ResponseEntity.status(HttpStatus.CREATED).headers(headers).body(task);
	}

	@PutMapping("/tasks")
	ResponseEntity<String> updateTask(@RequestBody Task task) {
		maintenanceService.updateTask(task);
		return ResponseEntity.status(HttpStatus.ACCEPTED).body("Update..");
	}

	@DeleteMapping("/tasks/{taskId}")
	ResponseEntity<String> deleteTask(@PathVariable("taskId") int taskId) {
		maintenanceService.deleteTask(taskId);
		return ResponseEntity.status(HttpStatus.OK).body("Deleted Successfully");
	}

	@GetMapping("/tasks/taskId/{taskId}")
	ResponseEntity<Task> getByTaskId(@PathVariable("taskId") int taskId) {
		task = maintenanceService.getByTaskId(taskId);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get One Task By Id");
		headers.add("info", "Returning one task");
		ResponseEntity<Task> taskResponse = new ResponseEntity<Task>(task, headers, HttpStatus.OK);
		return taskResponse;
	}

	@GetMapping("/tasks")
	ResponseEntity<List<Task>> getAllTask() {
		List<Task> taskList = maintenanceService.getAllTask();
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get all tasks");
		return ResponseEntity.accepted().headers(headers).body(taskList);
	}

	//*
	@GetMapping("/tasks/maintenanceId/{maintenanceId}")
	ResponseEntity<List<Task>> getByMaintenanceId(@PathVariable("maintenanceId") int maintenanceId) {
		List<Task> taskList = maintenanceService.getByMaintenanceId(maintenanceId);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get One Task By  maintenanceId");
		headers.add("info", "Returning one task");
		return ResponseEntity.accepted().headers(headers).body(taskList);
	}

	@GetMapping("/tasks/organiser/{organiser}/tStatus/{tStatus}")
	ResponseEntity<Task> getByOrganiserAndStatus(@PathVariable("organiser") String organiser,
			@PathVariable("tStatus") String tStatus) {
		task = maintenanceService.getByOrganiserAndStatus(organiser, tStatus);
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get Tasklist By organiser and status");
		return ResponseEntity.ok().headers(headers).body(task);
	}

	//*
	@GetMapping("/tasks/tStartDate/{tStartDate}/tEndDate/{tEndDate}")
	ResponseEntity<Task> getByTaskStartDateAndEndDate(@PathVariable("tStartDate") String tStartDate,
			@PathVariable("tEndDate") String tEndDate) {
		task = maintenanceService.getByTaskStartDateAndEndDate(LocalDate.parse(tStartDate),
				LocalDate.parse(tEndDate));
		HttpHeaders headers = new HttpHeaders();
		headers.add("desc", "Get Task By StartDate and EndDate");
		return ResponseEntity.ok().headers(headers).body(task);
	}

}
